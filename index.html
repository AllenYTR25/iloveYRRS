<script>
    const container = document.getElementById('container');
    const screenHeight = window.innerHeight;
    const screenWidth = window.innerWidth;

    const columnCount = 20;
    const fontSize = 16;
    let syncFalling = true;

    function createColumn(xPos) {
        const col = document.createElement('div');
        col.classList.add('column');
        col.style.left = xPos + 'px';
        return col;
    }

    const columns = [];
    const spacing = Math.floor(screenWidth / columnCount);

    for (let i = 0; i < columnCount; i++) {
        const col = createColumn(i * spacing);
        container.appendChild(col);

        columns.push({
            element: col,
            y: -100 * Math.random(),
            speed: 0.3 + Math.random() * 0.7, // Velocidad más lenta
            disappearPoint: screenHeight * (0.7 + Math.random() * 0.2),
        });

        for (let j = 0; j < 60; j++) {
            const texto = document.createElement('div');
            texto.classList.add('te-amo');
            texto.textContent = 'te amo <3';
            col.appendChild(texto);
        }
    }

    function animate() {
        columns.forEach(col => {
            if (syncFalling) {
                col.y += 1; // Caída inicial sincronizada más lenta
            } else {
                col.y += col.speed; // Velocidades individuales más lentas
            }
            col.element.style.top = col.y + 'px';

            Array.from(col.element.children).forEach((child, idx) => {
                const positionInColumn = idx * fontSize;
                const visibilityThreshold = col.y - positionInColumn;

                if (visibilityThreshold > 0 && visibilityThreshold < screenHeight) {
                    child.style.opacity = `${visibilityThreshold / screenHeight}`;
                } else if (visibilityThreshold >= screenHeight) {
                    child.style.opacity = '1';
                } else {
                    child.style.opacity = '0';
                }
            });

            if (col.y > col.disappearPoint) {
                col.y = -50 * Math.random();
                col.speed = 0.3 + Math.random() * 0.7; // Reiniciar con velocidad lenta
            }
        });

        if (syncFalling) {
            setTimeout(() => {
                syncFalling = false;
            }, 3000);
        }

        requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener('resize', () => {
        location.reload();
    });
</script>

